function Workbook(){if(!(this instanceof Workbook))return new Workbook;this.SheetNames=[];this.Sheets={}}var Jhxlsx={config:{fileName:"report",extension:".xlsx",sheetName:"Sheet",fileFullName:"report.xlsx",header:!0,createEmptyRow:!0,maxCellWidth:20},worksheetObj:{},rowCount:0,wsColswidth:[],merges:[],worksheet:{},range:{},init:function(n){if(this.reset(),n)for(var t in this.config)n.hasOwnProperty(t)&&(this.config[t]=n[t]);this.config.fileFullName=this.config.fileName+this.config.extension},reset:function(){this.range={s:{c:1e7,r:1e7},e:{c:0,r:0}};this.worksheetObj={};this.rowCount=0;this.wsColswidth=[];this.merges=[];this.worksheet={}},parse2Int0:function(n){return n=parseInt(n),Number.isNaN(n)?0:n},cellWidth:function(n,t){var i=n&&n.length*1.3;this.wsColswidth[t]?i>this.wsColswidth[t].wch&&(this.wsColswidth[t]={wch:i}):this.wsColswidth[t]={wch:i}},cellWidthValidate:function(){for(var n in this.wsColswidth)this.wsColswidth[n].wch>this.config.maxCellWidth&&(this.wsColswidth[n].wch=this.config.maxCellWidth)},datenum:function(n,t){t&&(n+=1462);var i=Date.parse(n);return(i-new Date(Date.UTC(1899,11,30)))/864e5},setCellDataType:function(n){typeof n.v=="number"?n.t="n":typeof n.v=="boolean"?n.t="b":n.v instanceof Date?(n.t="n",n.z=XLSX.SSF._table[14],n.v=this.datenum(n.v)):n.t="s"},jhAddRow:function(n){var t,i,f,r,e,u,o,s,h;for(t in n)(t=this.parse2Int0(t),i=n[t],this.range.s.r>this.rowCount&&(this.range.s.r=this.rowCount),this.range.s.c>t&&(this.range.s.c=t),this.range.e.r<this.rowCount&&(this.range.e.r=this.rowCount),this.range.e.c<t&&(this.range.e.c=t),f=null,i.hasOwnProperty("text")&&(f=i.text),r={v:f},e=!0,i.hasOwnProperty("merge")&&(u=i.merge,e=!1,o=t,s=this.rowCount,u.hasOwnProperty("c")&&(o=t+parseInt(u.c)),u.hasOwnProperty("r")&&(s=this.rowCount+parseInt(u.r)),this.merges.push({s:{r:this.rowCount,c:t},e:{r:s,c:o}})),e&&this.cellWidth(r.v,t),r.v!==null)&&(h=XLSX.utils.encode_cell({c:t,r:this.rowCount}),this.setCellDataType(r),i.hasOwnProperty("style")&&(r.s=i.style),this.worksheet[h]=r);this.rowCount++},createWorkSheet:function(){for(var n in this.worksheetObj.data)this.jhAddRow(this.worksheetObj.data[n]);return this.cellWidthValidate(),this.worksheet["!merges"]=this.merges,this.worksheet["!cols"]=this.wsColswidth,this.range.s.c<1e7&&(this.worksheet["!ref"]=XLSX.utils.encode_range(this.range)),this.worksheet},s2ab:function(n){for(var i=new ArrayBuffer(n.length),r=new Uint8Array(i),t=0;t!=n.length;++t)r[t]=n.charCodeAt(t)&255;return i},getBlob:function(n,t){var i,u,r,f,e;this.init(t);i=new Workbook;for(u in n)this.reset(),this.worksheetObj=n[u],r=this.config.sheetName+u,this.worksheetObj.hasOwnProperty("sheetName")&&(r=this.worksheetObj.sheetName),this.createWorkSheet(),i.SheetNames.push(r),i.Sheets[r]=this.worksheet;return f=XLSX.write(i,{bookType:"xlsx",bookSST:!0,type:"binary"}),e=new Blob([this.s2ab(f)],{type:"application/octet-stream"}),e},"export":function(n,t){saveAs(this.getBlob(n,t),this.config.fileFullName)}};