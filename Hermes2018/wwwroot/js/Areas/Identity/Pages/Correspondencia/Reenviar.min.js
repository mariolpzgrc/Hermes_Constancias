function getRoute(n){return objWebRoot.route+"api/v1/users/local/"+n}function filterProperties(n){for(var i=[],r,t=0;t<n.length;t++)r={value:$.trim(n[t].HER_NombreCompleto),userName:$.trim(n[t].HER_UserName),searchBy:$.trim(n[t].HER_UserName)+" "+$.trim(n[t].HER_Area),puesto:$.trim(n[t].HER_Puesto),area:$.trim(n[t].HER_Area)},i.push(r);return i}function checkUndefined(n){return n||""}function checkPuestoyArea(n){var t="";return n.puesto&&(t="<br><strong>Puesto: <\/strong>"+n.puesto),n.area&&(t+="<br><strong>Area: <\/strong>"+n.area),t}function getEmailDetails(n){var t;return n.miembros?(t="<ul type='circle'>",n.miembros.forEach(function(n){t+="<li>"+checkUndefined(n.nombre)+" - <i>"+n.userName+dominioCorreo+"<\/i><\/li>"}),t+="<\/ul>"):t=n.userName+dominioCorreo,t}function toPlainString(n){var t="";return n.forEach(function(n,i,r){t+=r.length-1==i?n:n+","}),t}function getEmailsParaToSend(){var n=[],t=$("#form-autocomplete-para").val(),i;if(t)return i=JSON.parse(t),i.forEach(function(t){t.miembros?t.miembros.forEach(function(t){n.includes(t.userName)||n.push(t.userName)}):n.includes(t.userName)||n.push(t.userName)}),toPlainString(n)}function getEmailsCCPToSend(){var n=[],t=$("#form-autocomplete-ccp").val(),i;if(t)return i=JSON.parse(t),i.forEach(function(t){n.includes(t.userName)||n.push(t.userName)}),toPlainString(n)}function updateHelperDataEmails(){$("#Reenviar_Para").val(getEmailsParaToSend());$("#Reenviar_CCP").val(getEmailsCCPToSend())}function ControlAutocompletarPara(){function i(n,t,i){$.getScript(objWebRoot.route+"lib/bootstrap-notify/bootstrap-notify.js",function(){$.notify({title:n,message:t},{type:"info",element:"#tagsEmailPara",delay:i,animate:{enter:"animated fadeInDown",exit:"animated fadeOutUp"}})})}function r(n,t){if(n){var i=JSON.parse(n);i.forEach(function(n){t.userName==n.userName&&tagifyEmailsCCP.removeTag(n.value)})}}function u(t){var i=t.detail,u,r;i.length>2&&(r=[],tagifyEmails.settings.whitelist.length=0,n&&n.abort(),n=new AbortController,u=getRoute(i),fetch(u,{headers:{Authorization:"Bearer "+objWebRoot.token}}).then(n=>n.json()).then(function(n){n.findIndex(n=>n.HER_UserName===objUser.username)>-1&&n.splice(n.findIndex(n=>n.HER_UserName===objUser.username),1);r=filterProperties(n);tagifyEmails.settings.whitelist=r;tagifyEmails.dropdown.show.call(tagifyEmails,i)}).catch(()=>{}))}function f(n){var t=JSON.parse($("#form-autocomplete-para").val()),i=n.detail.data;t=$("#form-autocomplete-ccp").val();r(t,i);updateHelperDataEmails()}function e(){updateHelperDataEmails()}function o(n){var t=n.detail.data,r;r="<br><strong>Nombre: <\/strong>"+t.value+checkPuestoyArea(t)+"<br><strong>Correo electrónico:<\/strong><br><i>"+getEmailDetails(t)+"<\/i>";i("Detalles del contacto",r,5e3)}const t=document.getElementById("form-autocomplete-para");tagifyEmails=new Tagify(t,{whitelist:[],enforceWhitelist:!0,dropdown:{enabled:3,fuzzySearch:!0,itemTemplate:function(n){return`<div class=tagify__dropdown__item>
                    <span style="font-weight: bold">${n.value}</span>
                    <span style="font-size: small;"> (${n.userName}) </span>
                    <span style="font-size: small; font-style: italic;"> - ${n.puesto} - </span>
                    <span style="font-size: small;">${n.area}</span> 
                </div>`}}});var n;tagifyEmails.on("input",u);tagifyEmails.on("add",f);tagifyEmails.on("remove",e);tagifyEmails.on("click",o)}function ControlAutocompletarConCopia(){function i(n,t,i){$.getScript(objWebRoot.route+"lib/bootstrap-notify/bootstrap-notify.js",function(){$.notify({title:n,message:t},{type:"info",element:"#tagsEmailCCP",delay:i,animate:{enter:"animated fadeInDown",exit:"animated fadeOutUp"}})})}function r(n,t){if(n){var i=JSON.parse(n);i.forEach(function(n){if(t.userName==n.userName){tagifyEmailsCCP.removeTag(t.value);$("#labelPara").removeClass().addClass("shake animated").one("webkitAnimationEnd mozAnimationEnd MSAnimationEnd oanimationend animationend",function(){$(this).removeClass()})}})}}function u(t){var i=t.detail,u,r;i.length>2&&(r=[],tagifyEmailsCCP.settings.whitelist.length=0,n&&n.abort(),n=new AbortController,u=getRoute(i),fetch(u,{signal:n.signal,headers:{Authorization:"Bearer "+objWebRoot.token}}).then(n=>n.json()).then(function(n){n.findIndex(n=>n.HER_UserName===objUser.username)>-1&&n.splice(n.findIndex(n=>n.HER_UserName===objUser.username),1);r=filterProperties(n);tagifyEmailsCCP.settings.whitelist=r;tagifyEmailsCCP.dropdown.show.call(tagifyEmailsCCP,i)}).catch(()=>{}))}function f(n){var t=$("#form-autocomplete-para").val(),i=n.detail.data;r(t,i);updateHelperDataEmails()}function e(){updateHelperDataEmails()}function o(n){var t=n.detail.data,r;r="<br><strong>Nombre: <\/strong>"+t.value+checkPuestoyArea(t)+"<br><strong>Correo electrónico: <\/strong><br><i>"+getEmailDetails(t)+"<\/i>";i("Detalles del contacto",r,5e3)}const t=document.getElementById("form-autocomplete-ccp");tagifyEmailsCCP=new Tagify(t,{whitelist:[],enforceWhitelist:!0,dropdown:{enabled:3,fuzzySearch:!0,itemTemplate:function(n){return`<div class=tagify__dropdown__item>
                    <span style="font-weight: bold">${n.value}</span>
                    <span style="font-size: small;"> (${n.userName}) </span>
                    <span style="font-size: small; font-style: italic;"> - ${n.puesto} - </span>
                    <span style="font-size: small;">${n.area}</span> 
                </div>`}}});var n;tagifyEmailsCCP.on("input",u);tagifyEmailsCCP.on("add",f);tagifyEmailsCCP.on("remove",e);tagifyEmailsCCP.on("click",o)}function ControlDropzone(){var n={listado:[],cadena:"",indice:0},t={url:objWebRoot.route+"api/v1/anexos/subir/archivo/temporal/"+objUser.usersession,acceptedFiles:objExtensiones.valores,dictDefaultMessage:"Arraste sus archivos aquí o haga clic para abrir el explorador",dictFallbackMessage:"Su navegador no admite la carga de archivos por medio de arrastrar y soltar.",dictFallbackText:"Utilice el formulario de reserva para cargar sus archivos como en los viejos tiempos.",dictFileTooBig:"El archivo es demasiado grande ({{filesize}}MiB). Tamaño máximo de archivo: {{maxFilesize}}MiB.",dictInvalidFileType:"No puedes subir archivos de este tipo.",dictResponseError:"El servidor respondió con el código {{statusCode}}.",dictCancelUpload:"Cancelar carga",dictCancelUploadConfirmation:"¿Estás seguro de que deseas cancelar esta carga?",dictRemoveFile:"Remover archivo",dictMaxFilesExceeded:"No puedes subir más archivos.",dictRemoveFile:"x",createImageThumbnails:!0,addRemoveLinks:!0,maxFiles:10,maxFilesize:25,success:function(t,i){if(i.trim().length>0)$.inArray(i,n.listado)===-1&&(n.listado.push(i),n.cadena="",$.each(n.listado,function(t,i){n.cadena=n.cadena+i;t+1<n.listado.length&&(n.cadena=n.cadena+",")}),$("#Reenviar_Anexos").val(n.cadena));else{this.removeFile(t);var r=t.previewElement;r!==null?r.parentNode.removeChild(t.previewElement):void 0}},renameFile:function(n){var t=n.name;t.includes(",")&&(t=t.replace(/,/g,"-"));let i=t;return n.newName=i,i},error:function(n,t){alert(t);this.removeFile(n);var i=n.previewElement;i!==null?i.parentNode.removeChild(n.previewElement):void 0},removedfile:function(t){$.ajax({url:objWebRoot.route+"api/v1/anexos/borrar/archivo/temporal",type:"POST",data:JSON.stringify({Folio:objUser.usersession,NombreArchivo:t.name}),datatype:"application/json",contentType:"application/json",beforeSend:function(n){n.setRequestHeader("Authorization","Bearer "+objWebRoot.token)},success:function(i){if(i.trim().length>0){n.indice=$.inArray(i,n.listado);n.indice>-1&&n.listado.splice(n.indice,1);n.cadena="";$.each(n.listado,function(t,i){n.cadena=n.cadena+i;t+1<n.listado.length&&(n.cadena=n.cadena+",")});$("#Reenviar_Anexos").val(n.cadena);var r=t.previewElement;return r!==null?r.parentNode.removeChild(t.previewElement):void 0}}})},headers:{Authorization:"Bearer "+objWebRoot.token}};$("#uploader").dropzone(t)}function CargaArchivosSoloLectura(){objListadoArchivos.uri=objWebRoot.route+"api/v1/anexos/descarga/envios";objListadoArchivos.paramFolio=objFolio.folio;objListadoArchivos.datos=Object.keys({});$.ajax({url:objListadoArchivos.uri,type:"POST",data:JSON.stringify({Folio:objListadoArchivos.paramFolio,TipoEnvioId:objParam.tipoEnvio,EnvioId:objParam.envioId}),datatype:"application/json",contentType:"application/json",beforeSend:function(n){n.setRequestHeader("Authorization","Bearer "+objWebRoot.token)},success:function(n){n!==""&&(objListadoArchivos.datos=Object.keys({}),objListadoArchivos.datos=n,$.each(objListadoArchivos.datos,function(n,t){$("#containerArchivos").append($('<span class="tm-tag cm-tag"><a class="cmt-titulo" href="'+objWebRoot.route+t.Ruta+'" download>'+t.Nombre+"<\/a><\/span>"))}))}})}var objWebRoot={route:"",token:""},tagifyEmails,tagifyEmailsCPP,objUser={username:"",usersession:""},objExtensiones={valores:"image/*,application/pdf,text/plain,.doc,.docx,.xlsx,.xls,.ppt"},objListadoArchivos={uri:"",paramFolio:"",datos:Object.keys({})},objParam={envioId:0,tipoEnvio:0},objAdjuntos={existen:!1},objFolio={folio:""},objEditor={froala:null},objCalendario={datePicker:null,dias:"",datos:[],inicio:"",limite:""},objp,dominioCorreo,objRequiereRespuesta;$(function(){objWebRoot.route=$("#routeWebRoot").val();objWebRoot.token=$("#TokenWebApi").val();objUser.username=$("#user").text();objUser.usersession=$("#Reenviar_FolioSession").val();objExtensiones.valores=$("#Reenviar_Extensiones").val();objFolio.folio=$("#folioInput").val();objParam.envioId=parseInt($("#envio_identifica").text());objParam.tipoEnvio=parseInt($("#tipo_envio").text());objAdjuntos.existen=$("#Reenviar_ExisteAdjuntos").val().toLowerCase()==="true"?!0:!1;objCalendario.dias=$("#Inhabiles_Dias").val();objCalendario.datos=objCalendario.dias.split(",");objCalendario.inicio=$("#Inhabiles_Inicio").val();objCalendario.limite=$("#Inhabiles_Limite").val();ControlAutocompletarPara();ControlAutocompletarConCopia();ControlDropzone();CargaArchivosSoloLectura();objEditor.froala=new FroalaEditor("#Reenviar_Indicaciones",{key:"UBB7jE6D5G3I3A2A6aIVLEABVAYFKc1Ce1MYGD1c1NYVMiB3B9B6B5C2B4C3H3I3I3==",toolbarButtons:["fullscreen","bold","italic","fontSize","underline","|","align","formatOL","formatUL","|","insertLink","|","clearFormatting","selectAll","|","undo","redo"],attribution:!1,scaytAutoload:!0,language:"es",iframe:!0,heightMin:300,heightMax:400,theme:"gray",placeholderText:"Escriba el contenido",wordPasteModal:!0,pastePlain:!0,wordDeniedAttrs:["style","width","height"],quickInsertTags:[""],fontSizeSelection:!0,fontSize:["8","10","12","14","16","18"],fontSizeDefaultSelection:"16",listAdvancedTypes:!1});objCalendario.datePicker=flatpickr("#fechaCompromiso",{dateFormat:"d/m/Y",minDate:"today",locale:{firstDayOfWeek:7,weekdays:{shorthand:["Do","Lu","Ma","Mi","Ju","Vi","Sa"],longhand:["Domingo","Lunes","Martes","Miércoles","Jueves","Viernes","Sábado"]},months:{shorthand:["Ene","Feb","Mar","Abr","May","Jun","Jul","Ago","Sep","Оct","Nov","Dic"],longhand:["Enero","Febrero","Мarzo","Abril","Mayo","Junio","Julio","Agosto","Septiembre","Octubre","Noviembre","Diciembre"]}},disable:objCalendario.datos,maxDate:objCalendario.limite});$("#Reenviar_RequiereRespuesta").change(function(){$("#Reenviar_RequiereRespuesta option:selected").val()=="false"?($("#fechaCompromiso").val(""),$("#contieneFechapc").hide()):$("#contieneFechapc").show()})});$.validator.setDefaults({ignore:[]});Dropzone.autoDiscover=!1;objp={urln:""};dominioCorreo="@uv.mx";objRequiereRespuesta={valor:!1};$.validator.addMethod("condicionbolean",function(n,t,i){return objRequiereRespuesta.valor=$("#Reenviar_"+i[0]+" option:selected").val()=="true",objRequiereRespuesta.valor?$.trim(n).length===0||n===0?!1:!0:!0});$.validator.unobtrusive.adapters.add("condicionbolean",["dependencia"],function(n){n.rules.condicionbolean=[n.params.dependencia];n.messages.condicionbolean=n.message});