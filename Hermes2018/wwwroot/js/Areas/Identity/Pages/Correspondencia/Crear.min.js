function ControlTipoDocumento(){objTipoDocumento.seleccionado=parseInt($("#CrearDocumento_TipoId option:selected").val());objTipoDocumento.seleccionado===objTipoDocumento.memorandum?$("#leyenda-tipo-documento").text("Memorándum"):$("#leyenda-tipo-documento").text("");$("#CrearDocumento_TipoId").change(function(){objTipoDocumento.seleccionado=parseInt($("#CrearDocumento_TipoId option:selected").val());objTipoDocumento.seleccionado===objTipoDocumento.memorandum?$("#leyenda-tipo-documento").text("Memorándum"):$("#leyenda-tipo-documento").text("")})}function ControlRevisionCheck(){var r=$("#checkRevision"),n=document.getElementById("grupoSelect"),t=document.getElementById("serviciosSelect"),i=$("#tagsEmailCCP");r.prop("checked")?(n.disabled=!0,t.disabled=!0,i.hide(),tagifyEmails.settings.maxTags=1):(n.disabled=!1,t.disabled=!1,i.show(),tagifyEmails.settings.maxTags=Infinity)}function getRoute(n){return objWebRoot.route+"api/v1/users/local/"+n}function getRouteRevision(n){return objWebRoot.route+"api/v1/users/revision/"+objUser.username+"/"+objUser.area+"/"+n}function filterProperties(n){for(var i=[],r,t=0;t<n.length;t++)r={value:$.trim(n[t].HER_NombreCompleto),userName:$.trim(n[t].HER_UserName),searchBy:$.trim(n[t].HER_UserName)+" "+$.trim(n[t].HER_Area),puesto:$.trim(n[t].HER_Puesto),area:$.trim(n[t].HER_Area)},i.push(r);return i}function checkUndefined(n){return n||""}function checkPuestoyArea(n){var t="";return n.puesto&&(t="<br><strong>Puesto: <\/strong>"+n.puesto),n.area&&(t+="<br><strong>Area: <\/strong>"+n.area),t}function getEmailDetails(n){var t;return n.miembros?(t="<ul type='circle'>",n.miembros.forEach(function(n){t+="<li>"+checkUndefined(n.nombre)+" - <i>"+n.userName+dominioCorreo+"<\/i><\/li>"}),t+="<\/ul>"):t=n.userName+dominioCorreo,t}function toPlainString(n){var t="";return n.forEach(function(n,i,r){t+=r.length-1===i?n:n+","}),t}function getEmailsParaToSend(){var n=[],t=$("#form-autocomplete-para").val(),i;if(t)return i=JSON.parse(t),i.forEach(function(t){t.miembros?t.miembros.forEach(function(t){n.includes(t.userName)||n.push(t.userName)}):n.includes(t.userName)||n.push(t.userName)}),toPlainString(n)}function getEmailsCCPToSend(){var n=[],t=$("#form-autocomplete-ccp").val(),i;if(t)return i=JSON.parse(t),i.forEach(function(t){n.includes(t.userName)||n.push(t.userName)}),toPlainString(n)}function updateHelperDataEmails(){$("#CrearDocumento_Para").val(getEmailsParaToSend());$("#CrearDocumento_CCP").val(getEmailsCCPToSend())}function ControlAutocompletarPara(){function t(n,t,i){$.getScript(objWebRoot.route+"lib/bootstrap-notify/bootstrap-notify.js",function(){$.notify({title:n,message:t},{type:"info",element:"#tagsEmailPara",delay:i,animate:{enter:"animated fadeInDown",exit:"animated fadeOutUp"}})})}function r(n,t){n.forEach(function(n){for(var i=0;i<t.length;i++)t[i].userName===n.userName&&tagifyEmails.removeTag(t[i].value)})}function u(n,t){if(t){var i=JSON.parse(t);i.forEach(function(t){n.forEach(function(n){n.userName===t.userName&&tagifyEmailsCCP.removeTag(t.value)})})}}function f(n,i){n.forEach(function(n){if(n.miembros){var r=n.miembros;for(j=0;j<r.length;j++)if(r[j].userName===i.userName){tagifyEmails.removeTag(i.value);tagifyEmailsCCP.removeTag(i.value);t("<strong>Duplicado<\/strong><br>","Destinatario incluido en grupo o servicio",3e3);break}}})}function e(n,t){if(n){var i=JSON.parse(n);i.forEach(function(n){t.userName===n.userName&&tagifyEmailsCCP.removeTag(n.value)})}}function o(t){var i=t.detail,u,f,r;i.length>2&&(u=$("#checkRevision"),r=[],tagifyEmails.settings.whitelist.length=0,n&&n.abort(),n=new AbortController,f=u.prop("checked")?getRouteRevision(i):getRoute(i),fetch(f,{headers:{Authorization:"Bearer "+objWebRoot.token}}).then(n=>n.json()).then(function(n){n.findIndex(n=>n.HER_UserName===objUser.username)>-1&&n.splice(n.findIndex(n=>n.HER_UserName===objUser.username),1);r=filterProperties(n);tagifyEmails.settings.whitelist=r;tagifyEmails.dropdown.show.call(tagifyEmails,i)}).catch(()=>{}))}function s(n){var t=JSON.parse($("#form-autocomplete-para").val()),i,o;n.detail.data.miembros?(i=n.detail.data.miembros,r(i,t),t=$("#form-autocomplete-ccp").val(),u(i,t)):(o=n.detail.data,f(t,o),t=$("#form-autocomplete-ccp").val(),e(t,o));updateHelperDataEmails()}function h(){updateHelperDataEmails()}function c(n){var i=n.detail.data,r;r="<br><strong>Nombre: <\/strong>"+i.value+checkPuestoyArea(i)+"<br><strong>Correo electrónico:<\/strong><br><i>"+getEmailDetails(i)+"<\/i>";t("Detalles del contacto",r,5e3)}const i=document.getElementById("form-autocomplete-para");tagifyEmails=new Tagify(i,{whitelist:[],enforceWhitelist:!0,dropdown:{enabled:3,fuzzySearch:!0,itemTemplate:function(n){return`<div class=tagify__dropdown__item>
                    <span style="font-weight: bold">${n.value}</span>
                    <span style="font-size: small;"> (${n.userName}) </span>
                    <span style="font-size: small;font-style: italic;"> - ${n.puesto} - </span>
                    <span style="font-size: small;">${n.area}</span> 
                </div>`}}});var n;tagifyEmails.on("input",o);tagifyEmails.on("add",s);tagifyEmails.on("remove",h);tagifyEmails.on("click",c);document.querySelector("#checkRevision").addEventListener("click",tagifyEmails.removeAllTags.bind(tagifyEmails))}function ControlAutocompletarConCopia(){function t(n,t,i){$.getScript(objWebRoot.route+"lib/bootstrap-notify/bootstrap-notify.js",function(){$.notify({title:n,message:t},{type:"info",element:"#tagsEmailCCP",delay:i,animate:{enter:"animated fadeInDown",exit:"animated fadeOutUp"}})})}function r(n,t){if(n){var i=JSON.parse(n);i.forEach(function(n){if(t.userName===n.userName){tagifyEmailsCCP.removeTag(t.value);$("#labelPara").removeClass().addClass("shake animated").one("webkitAnimationEnd mozAnimationEnd MSAnimationEnd oanimationend animationend",function(){$(this).removeClass()})}})}}function u(n,i){if(n){var r=JSON.parse(n);r.forEach(function(n){if(n.miembros){var r=n.miembros;for(j=0;j<r.length;j++)if(r[j].userName===i.userName){tagifyEmailsCCP.removeTag(i.value);t("<strong>Duplicado<\/strong><br>","Destinatario incluido en grupo o servicio",3e3);break}}})}}function f(t){var i=t.detail,u,r;i.length>2&&(r=[],tagifyEmailsCCP.settings.whitelist.length=0,n&&n.abort(),n=new AbortController,u=getRoute(i),fetch(u,{signal:n.signal,headers:{Authorization:"Bearer "+objWebRoot.token}}).then(n=>n.json()).then(function(n){n.findIndex(n=>n.HER_UserName===objUser.username)>-1&&n.splice(n.findIndex(n=>n.HER_UserName===objUser.username),1);r=filterProperties(n);tagifyEmailsCCP.settings.whitelist=r;tagifyEmailsCCP.dropdown.show.call(tagifyEmailsCCP,i)}).catch(()=>{}))}function e(n){var t=$("#form-autocomplete-para").val(),i=n.detail.data;u(t,i);r(t,i);updateHelperDataEmails()}function o(){updateHelperDataEmails()}function s(n){var i=n.detail.data,r;r="<br><strong>Nombre: <\/strong>"+i.value+checkPuestoyArea(i)+"<br><strong>Correo electrónico: <\/strong><br><i>"+getEmailDetails(i)+"<\/i>";t("Detalles del contacto",r,5e3)}const i=document.getElementById("form-autocomplete-ccp");tagifyEmailsCCP=new Tagify(i,{whitelist:[],enforceWhitelist:!0,dropdown:{enabled:3,fuzzySearch:!0,itemTemplate:function(n){return`<div class=tagify__dropdown__item>
                    <span style="font-weight: bold">${n.value}</span>
                    <span style="font-size: small;"> (${n.userName}) </span>
                    <span style="font-size: small; font-style: italic;"> - ${n.puesto} - </span>
                    <span style="font-size: small;">${n.area}</span> 
                </div>`}}});var n;tagifyEmailsCCP.on("input",f);tagifyEmailsCCP.on("add",e);tagifyEmailsCCP.on("remove",o);tagifyEmailsCCP.on("click",s);document.querySelector("#checkRevision").addEventListener("click",tagifyEmailsCCP.removeAllTags.bind(tagifyEmailsCCP))}function GetGrupos(){var t={urln:""},n;t.urln=objWebRoot.route+"api/v1/grupos/"+objUser.username;n=document.getElementById("grupoSelect");$.ajax({url:t.urln,type:"GET",datatype:"application/json",beforeSend:function(n){n.setRequestHeader("Authorization","Bearer "+objWebRoot.token)},success:function(t){$.each(t,function(t,i){n.options[n.options.length]=new Option(i.HER_Nombre,i.HER_GrupoId)})}})}function getMembersGroup(n){var t=[],i,r={urln:""};return r.urln=objWebRoot.route+"api/v1/grupos/usuarios/"+n,$.ajax({url:r.urln,type:"GET",datatype:"application/json",async:!1,beforeSend:function(n){n.setRequestHeader("Authorization","Bearer "+objWebRoot.token)},success:function(n){$.each(n,function(n,r){i={userName:r.HER_UserName,nombre:r.HER_NombreCompleto};t.push(i)})}}),t}function AplicarGrupo(){var n=document.getElementById("grupoSelect"),t=n.options[n.selectedIndex],r=getMembersGroup(t.value),i=[{miembros:r,value:t.text}];tagifyEmails.settings.whitelist=i;tagifyEmails.addTags(i);$("#grupoSelect").val($("#grupoSelect").data("default-value"))}function CambiarFlecha(){$("#flecha1").attr("class")==="fas fa-angle-down"?$("#flecha1").attr("class","fas fa-angle-up"):$("#flecha1").attr("class","fas fa-angle-down")}function GetServicios(){var n=document.getElementById("serviciosSelect");objServicios.urln=objWebRoot.route+"api/v1/servicios";$.ajax({url:objServicios.urln,type:"GET",datatype:"application/json",beforeSend:function(n){n.setRequestHeader("Authorization","Bearer "+objWebRoot.token)},success:function(t){objServicios.datos=t;$.each(t,function(t,i){var r=[i.HER_Integrantes[0].HER_UserName,i.HER_Integrantes[0].HER_NombreCompleto];n.options[n.options.length]=new Option(i.HER_Servicio_Nombre,r)})}})}function AplicarServicio(){var n=document.getElementById("serviciosSelect"),t=n.options[n.selectedIndex],i=t.value.split(","),r=[{miembros:[{userName:i[0],nombre:i[1]}],value:t.text}];tagifyEmails.settings.whitelist=r;tagifyEmails.addTags(r);$("#serviciosSelect").val($("#serviciosSelect").data("default-value"))}function ControlDropzone(){var n={url:objWebRoot.route+"api/v1/anexos/subir/archivo/temporal/"+objUser.usersession,acceptedFiles:objExtensiones.valores,dictDefaultMessage:"Arrastre sus archivos aquí o haga clic para abrir el explorador",dictFallbackMessage:"Su navegador no admite la carga de archivos por medio de arrastrar y soltar.",dictFallbackText:"Utilice el formulario de reserva para cargar sus archivos como en los viejos tiempos.",dictFileTooBig:"El archivo es demasiado grande ({{filesize}}MiB). Tamaño máximo de archivo: {{maxFilesize}}MiB.",dictInvalidFileType:"No puedes subir archivos de este tipo.",dictResponseError:"El servidor respondió con el código {{statusCode}}.",dictCancelUpload:"Cancelar carga",dictCancelUploadConfirmation:"¿Estás seguro de que deseas cancelar esta carga?",dictRemoveFile:"Remover archivo",dictMaxFilesExceeded:"No puedes subir más archivos.",dictRemoveFile:"x",createImageThumbnails:!0,addRemoveLinks:!0,maxFiles:10,maxFilesize:25,success:function(n,t){if(t.trim().length>0)$.inArray(t,objarchivos.listado)===-1&&(objarchivos.listado.push(t),objarchivos.cadena="",$.each(objarchivos.listado,function(n,t){objarchivos.cadena=objarchivos.cadena+t;n+1<objarchivos.listado.length&&(objarchivos.cadena=objarchivos.cadena+",")}),$("#CrearDocumento_Anexos").val(objarchivos.cadena));else{this.removeFile(n);var i=n.previewElement;i!==null?i.parentNode.removeChild(n.previewElement):void 0}},renameFile:function(n){var t=n.name;t.includes(",")&&(t=t.replace(/,/g,"-"));let i=t;return n.newName=i,i},error:function(n,t){alert(t);this.removeFile(n);var i=n.previewElement;i!==null?i.parentNode.removeChild(n.previewElement):void 0},removedfile:function(n){$.ajax({url:objWebRoot.route+"api/v1/anexos/borrar/archivo/temporal",type:"POST",data:JSON.stringify({Folio:objUser.usersession,NombreArchivo:n.name}),datatype:"application/json",contentType:"application/json",beforeSend:function(n){n.setRequestHeader("Authorization","Bearer "+objWebRoot.token)},success:function(t){if(t.trim().length>0){objarchivos.indice=$.inArray(t,objarchivos.listado);objarchivos.indice>-1&&objarchivos.listado.splice(objarchivos.indice,1);objarchivos.cadena="";$.each(objarchivos.listado,function(n,t){objarchivos.cadena=objarchivos.cadena+t;n+1<objarchivos.listado.length&&(objarchivos.cadena=objarchivos.cadena+",")});$("#CrearDocumento_Anexos").val(objarchivos.cadena);var i=n.previewElement;return i!==null?i.parentNode.removeChild(n.previewElement):void 0}}})},headers:{Authorization:"Bearer "+objWebRoot.token}};$("#uploader").dropzone(n)}function ControlTags(){$("#buttonTag").click(function(){AddTag()})}function AddTag(){$("#tagsSaver").append('<div id="checkboxAdd"><small><div class=""><input class="form-control form-control-sm font-regular-10" id="nameTag" placeholder="Nombre categoría" required maxlength="100"/><\/div><div class="mb-2 text-center"><button id="agregarCategoria" type="button" class="btn btn-primary btn-sm pr-2 pl-2 mr-1"><i class="fa fa-check"><\/i><\/button><button class="btn btn-light btn-sm pr-2 pl-2" type="button" onclick="CancelarNuevaCategoria()"><i class="fas fa-times"><\/i><\/button><\/div><\/small><\/div>');$("#buttonTag").prop("disabled",!0)}function GetCategorias(){objCategorias.urln=objWebRoot.route+"api/v1/categorias/"+objUser.username;$.ajax({url:objCategorias.urln,type:"GET",datatype:"application/json",beforeSend:function(n){n.setRequestHeader("Authorization","Bearer "+objWebRoot.token)},success:function(n){$.each(n,function(n,t){t.Nombre==="General"?($("#tagsSaver").append('<input type="checkbox" class="categorias" id="catGeneral" value="'+t.CategoriaId+'" checked="true" /><small> '+t.Nombre+"<\/small><br/>"),objCategorias.seleccionadas.push(parseInt(t.CategoriaId))):$("#tagsSaver").append('<input type="checkbox" class="categorias" value="'+t.CategoriaId+'"/><small> '+t.Nombre+"<\/small><br/>")});$("#CrearDocumento_Categorias").val(objCategorias.seleccionadas.join(","));SeleccionCategoria()}})}function SeleccionCategoria(){$("#tagsSaver input[type=checkbox]").on("change",function(){objCategorias.seleccionadas=[];$("#tagsSaver input[type=checkbox]:checked").length===0&&$("input#catGeneral").prop("checked",!0);$("#tagsSaver input[type=checkbox]:checked").each(function(){objCategorias.seleccionadas.push(parseInt($(this).val()))});$("#CrearDocumento_Categorias").val(objCategorias.seleccionadas.join(","))})}function AgregarCategoria(){objc.urln=objWebRoot.route+"api/v1/categorias/agregar";$.ajax({url:objc.urln,type:"POST",data:JSON.stringify({Usuario:objUser.username,Categoria:$("#nameTag").val()}),datatype:"application/json",contentType:"application/json",beforeSend:function(n){n.setRequestHeader("Authorization","Bearer "+objWebRoot.token)},success:function(n){n.Estado===1?($("#tagsSaver").append('<input type="checkbox" class="categorias" value="'+n.CategoriaId+'"/><small> '+n.Nombre+"<\/small><br/>"),$("#checkboxAdd").empty(),$("#checkboxAdd").remove(),$("#buttonTag").prop("disabled",!1),SeleccionCategoria()):n.Estado===3?Notifica("No se ha puede guardar la categoría, ya existe una con el mismo nombre."):(n.Estado===2||n.Estado===4)&&Notifica("No se ha puede guardar la categoría, inténtelo más tarde.")}})}function CancelarNuevaCategoria(){$("#checkboxAdd").empty();$("#checkboxAdd").remove();$("#buttonTag").prop("disabled",!1)}function ControlCategoria(){$(document).on("click","#agregarCategoria",function(){objrefCategoria.inputCheckText=$("#nameTag").val();objrefCategoria.inputCheckText!==""&&AgregarCategoria()})}function AddTemplate(){$("#msg-validate-template").empty();$("#ButtonsOficio").append('<div id="TemplateForm" class="templateForm"><div><input type="text" id="nameTemplate" class="form-control form-control-sm text-center font-regular-10" placeholder="Nombre de plantilla" required maxlength="100" autocomplete="off" value=""><\/div><div><small id="msg-validate-textarea" class="text-danger"><\/small><\/div><div><button type="button" id="BtnSaveTemplate" class="btn btn-primary btn-sm pr-2 pl-2" type="button"><i class="fa fa-check"><\/i><\/button> <button type="button" id="disposeTemplate" class="btn btn-light btn-sm pr-2 pl-2" type="button"><i class="fas fa-times"><\/i><\/button><\/div><\/div>');$("#SaveAsTemplate").prop("disabled",!0)}function SaveTemplate(){var n={cuerpo:"",nombre:""},t;n.cuerpo=$("#CrearDocumento_Cuerpo").val();n.nombre=$("#nameTemplate").val();t={urln:""};t.urln=objWebRoot.route+"api/v1/plantillas/"+objUser.username;$.ajax({url:t.urln,type:"POST",data:JSON.stringify({HER_Texto:n.cuerpo,HER_Nombre:n.nombre}),contentType:"application/json",beforeSend:function(n){n.setRequestHeader("Authorization","Bearer "+objWebRoot.token)},success:function(n){n===0?Notifica("No se ha puede guardar la plantilla, inténtelo más tarde."):n===2&&Notifica("No se ha puede guardar la plantilla, ya existe una con el mismo nombre.");GetTemplates()}});$("#TemplateForm").empty();$("#TemplateForm").remove();$("#SaveAsTemplate").prop("disabled",!1);$("#msg-validate-template").text("Plantilla guardada");$("#msg-validate-template").addClass("text-success")}function AplicarPlantilla(){var n={urln:"",nombre:""};n.nombre=$("#plantillaSelect option:selected").val();n.nombre!==""&&(n.urln=objWebRoot.route+"api/v1/plantillas/"+n.nombre+":"+objUser.username,$.ajax({url:n.urln,type:"GET",datatype:"application/json",beforeSend:function(n){n.setRequestHeader("Authorization","Bearer "+objWebRoot.token)},success:function(n){objEditor.froala.html.set(n.HER_Texto)}}))}function GetTemplates(){$("#plantillaSelect").empty();$("#plantillaSelect").append("<option selected>Seleccione una plantilla <\/option>");var n={urln:""};n.urln=objWebRoot.route+"api/v1/plantillas/"+objUser.username;$.ajax({url:n.urln,type:"GET",datatype:"application/json",beforeSend:function(n){n.setRequestHeader("Authorization","Bearer "+objWebRoot.token)},success:function(n){$.each(n,function(n,t){$("<option>",{value:t.HER_Nombre}).html(t.HER_Nombre).appendTo($("#plantillaSelect"))})}})}function DisposeTemplate(){$("#TemplateForm").empty();$("#TemplateForm").remove();$("#SaveAsTemplate").prop("disabled",!1);flagTemplateValidation=!1}function ControlTemplate(){$(document).on("click","#BtnSaveTemplate",function(){objPlantilla.nombre=$("#nameTemplate").val();objPlantilla.cuerpo=$("#CrearDocumento_Cuerpo").val();objPlantilla.nombre!==""?objPlantilla.cuerpo!==""?SaveTemplate():$("#msg-validate-textarea").text("El dato cuerpo es requerido."):$("#msg-validate-textarea").text("El dato Nombre de plantilla es requerido.")});$("#SaveAsTemplate").click(function(){AddTemplate()});$(document).on("click","#disposeTemplate",function(){$("#msg-validate-textarea").empty();DisposeTemplate()})}function ControlAlerta(){var n=!1;document.querySelector("#send-new-ofi").addEventListener("click",function(){n=!0});document.querySelector("#savetest").addEventListener("click",function(){n=!0});window.onbeforeunload=function(){return n?undefined:"Are you sure to leave this page?"}}function ControlValidacion(){$.validator.addMethod("simple",function(n,t,i){return objSubmitActual.valor=$("#CrearDocumento_"+i[0]).val(),objSubmitActual.valor===i[1]?$.trim(n).length===0?!1:!0:!0});$.validator.unobtrusive.adapters.add("simple",["dependencia","valor"],function(n){n.rules.simple=[n.params.dependencia,n.params.valor];n.messages.simple=n.message})}function ControSubmit(){$("#send-new-ofi").click(function(){$("#CrearDocumento_TipoSubmit").val(objTipoSubmit.enviar)});$("#savetest").click(function(){$("#CrearDocumento_TipoSubmit").val(objTipoSubmit.guardar)})}function ControlToggleEncabezado(){$("#btn-control-encabezado").click(function(){$("#control-toggle-encab").toggle(190,"linear",function(){$("#control-toggle-encab").is(":visible")?($("#btn-control-encabezado").empty(),$("#btn-control-encabezado").append($('<i class="fas fa-angle-double-up"><\/i>')),$("#resumen").removeClass("d-none"),$("#resumen").addClass("d-none"),$("#resumen").removeClass("d-inline-block")):($("#btn-control-encabezado").empty(),$("#btn-control-encabezado").append($('<i class="fas fa-angle-double-down"><\/i>')),objresumen.de=$("#labelfrom").text(),objresumen.asunto=$("#asunto").val(),objresumen.para="",objresumen.ccp="",$("#tagsEmailPara label.label-fill tags tag").each(function(){objresumen.para=objresumen.para.length>0?objresumen.para+", "+$(this).attr("value"):$(this).attr("value")}),$("#tagsEmailCCP label.label-fill tags tag").each(function(){objresumen.ccp=objresumen.ccp.length>0?objresumen.ccp+", "+$(this).attr("value"):$(this).attr("value")}),$("#resumen").removeClass("d-none"),$("#resumen").removeClass("d-inline-block"),$("#resumen").addClass("d-inline-block"),$("#resumen .resumen-de").text(objresumen.de),$("#resumen .resumen-para").text(objresumen.para),$("#resumen .resumen-CCP").text(objresumen.ccp),$("#resumen .resumen-asunto").text(objresumen.asunto))})})}function Notifica(n){$.notify({message:n},{type:"info",newest_on_top:!0,delay:3e3,animate:{enter:"animated fadeInDown",exit:"animated fadeOutUp"}})}var objWebRoot={route:"",token:""},objUser={username:"",usersession:""},objTipoSubmit={guardar:1,enviar:2},objresumen={de:"",para:"",ccp:"",asunto:""},objPlantilla={nombre:"",cuerpo:""},objExtensiones={valores:""},objFolio={folio:""},objTipoDocumento={oficio:1,memorandum:2,seleccionado:0},tagifyEmails,tagifyEmailsCPP,objEditor={froala:null},objCalendario={datePicker:null,dias:"",datos:[],inicio:"",limite:""},objp,dominioCorreo,objServicios,objarchivos,objCategorias,objc,objrefCategoria,objSubmitActual,objRequiereRespuesta;$(function(){objWebRoot.route=$("#routeWebRoot").val();objWebRoot.token=$("#TokenWebApi").val();objUser.username=$("#user").text();objUser.usersession=$("#CrearDocumento_FolioSession").val();objUser.area=$("#user-area-id").text();objExtensiones.valores=$("#CrearDocumento_Extensiones").val();objFolio.folio=$("#folioInput").val();$("#checkRevision").val=!1;objCalendario.dias=$("#Inhabiles_Dias").val();console.log(objCalendario.dias);objCalendario.datos=objCalendario.dias.split(",");objCalendario.inicio=$("#Inhabiles_Inicio").val();objCalendario.limite=$("#Inhabiles_Limite").val();objEditor.froala=new FroalaEditor("#CrearDocumento_Cuerpo",{key:"UBB7jE6D5G3I3A2A6aIVLEABVAYFKc1Ce1MYGD1c1NYVMiB3B9B6B5C2B4C3H3I3I3==",toolbarButtons:["fullscreen","bold","italic","textColor","fontSize","underline","subscript","superscript","|","align","formatOL","formatUL","outdent","indent","|","insertLink","insertTable","|","clearFormatting","selectAll","|","undo","redo"],tableEditButtons:["tableHeader","tableRemove"," | ","tableRows","tableColumns"," | ","tableCells","tableCellVerticalAlign","tableCellHorizontalAlign",],colorsText:["#000000","#2E64FE","#088A29","#FF0000","#585858","#FFFF00","#8A084B"],attribution:!1,scaytAutoload:!0,language:"es",iframe:!0,heightMin:300,heightMax:400,theme:"gray",placeholderText:"Escriba su documento",wordPasteModal:!0,pastePlain:!0,wordDeniedAttrs:["style","width","height"],quickInsertTags:[""],imageMaxSize:3145728,fontSizeSelection:!0,fontSize:["8","10","12","14","16","18"],fontSizeDefaultSelection:"16",listAdvancedTypes:!1,imageUploadURL:objWebRoot.route+"api/v1/CargaImagenes/"+objUser.username+"/"+objFolio.folio,requestHeaders:{Authorization:"Bearer "+objWebRoot.token},events:{"image.removed":function(n){$.ajax({method:"POST",url:objWebRoot.route+"api/v1/EliminaImagenes",beforeSend:function(n){n.setRequestHeader("Authorization","Bearer "+objWebRoot.token)},data:{src:n.attr("src")}}).done(function(){console.log("Image was deleted")}).fail(function(n){console.log("Image delete problem: "+JSON.stringify(n))})}}});$("form").each(function(){$(this).data("validator")&&($(this).data("validator").settings.ignore=".fr-box *")});ControlAutocompletarPara();ControlAutocompletarConCopia();GetGrupos();GetServicios();GetCategorias();ControlDropzone();ControlTags();ControlTemplate();ControlValidacion();ControlCategoria();ControlAlerta();ControSubmit();ControlToggleEncabezado();ControlTipoDocumento();$("#checkRevision").click(function(){ControlRevisionCheck()});$("#serviciosSelect").change(function(){AplicarServicio()});$("#grupoSelect").change(function(){AplicarGrupo()});$("#plantillaSelect").change(function(){AplicarPlantilla()});$("#CrearDocumento_RequiereRespuesta").change(function(){$("#CrearDocumento_RequiereRespuesta option:selected").val()=="false"?($("#fechaCompromiso").val(""),$("#contieneFechapc").hide()):$("#contieneFechapc").show()});objCalendario.datePicker=flatpickr("#fechaCompromiso",{dateFormat:"d/m/Y",minDate:objCalendario.inicio,locale:{firstDayOfWeek:7,weekdays:{shorthand:["Do","Lu","Ma","Mi","Ju","Vi","Sa"],longhand:["Domingo","Lunes","Martes","Miércoles","Jueves","Viernes","Sábado"]},months:{shorthand:["Ene","Feb","Mar","Abr","May","Jun","Jul","Ago","Sep","Оct","Nov","Dic"],longhand:["Enero","Febrero","Мarzo","Abril","Mayo","Junio","Julio","Agosto","Septiembre","Octubre","Noviembre","Diciembre"]}},disable:objCalendario.datos,maxDate:objCalendario.limite})});$.validator.setDefaults({ignore:[]});Dropzone.autoDiscover=!1;objp={urln:""};dominioCorreo="@uv.mx";objServicios={urln:"",datos:Object.keys({})};objarchivos={listado:[],cadena:"",indice:0};objCategorias={urln:"",seleccionadas:[]};objc={urln:""};objrefCategoria={inputCheckText:""};objSubmitActual={valor:""};objRequiereRespuesta={valor:!1};$.validator.addMethod("condicionbolean",function(n,t,i){return objRequiereRespuesta.valor=$("#CrearDocumento_"+i[0]+" option:selected").val()=="true",objRequiereRespuesta.valor?$.trim(n).length===0||n===0?!1:!0:!0});$.validator.unobtrusive.adapters.add("condicionbolean",["dependencia"],function(n){n.rules.condicionbolean=[n.params.dependencia];n.messages.condicionbolean=n.message});