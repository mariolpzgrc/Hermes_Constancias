function ControlAutocompletado(){$("input#Crear_Usuario").flexdatalist({cache:!1,multiple:!0,minLength:3,searchContain:!1,searchByWord:!0,maxShownResults:20,selectionRequired:!0,focusFirstResult:!0,searchIn:["HER_NombreCompleto","HER_UserName"],searchDelay:400,noResultsText:'No se han encontrado resultados para "{keyword}"',visibleProperties:["HER_NombreCompleto"],textProperty:"{HER_UserName}",valueProperty:"HER_UserName",removeOnBackspace:!0,valuesSeparator:",",limitOfValues:1,url:objWebRoot.route+"api/v1/users/busqueda/local/"+objUser.username,requestHeaders:{Authorization:"Bearer "+objWebRoot.token}});$("input#Crear_Usuario").on("select:flexdatalist",function(n,t){$("#Crear_Nombre").val(t.HER_NombreCompleto);$("#Crear_Correo").val(t.HER_Correo)});$("input#Crear_Usuario").on("after:flexdatalist.remove",function(){$("#control-busqueda ul > li.input-container").show();$("#Crear_Nombre").val("");$("#Crear_Correo").val("")});$("input#Crear_Usuario").on("after:flexdatalist.search",function(){})}function ControlAgregarUsuarios(){$("#btn-add-users").click(function(){objusuarioActual.nombre=$("#Crear_Nombre").val();objusuarioActual.username=$("#Crear_Usuario").val();objusuarioActual.email=$("#Crear_Correo").val();objusuarioActual.nombre!==""&&objusuarioActual.username!==""&&objusuarioActual.email!==""&&(objusuariosEnSeleccion.listado.findIndex(n=>n.username===objusuarioActual.username)===-1&&(objusuariosEnSeleccion.listado.push({nombre:objusuarioActual.nombre,username:objusuarioActual.username,email:objusuarioActual.email}),MostrarEnTabla()),LimpiarInfo())})}function Precarga(){objprecarga.conteo=$("#add-content-users").find("tr").length;objprecarga.conteo>0&&(LimpiarUsuarioActual(),$("#add-content-users").find("tr").each(function(){objusuarioActual.username=$(this).children(":nth-child(2)").find("Input").val();objusuarioActual.nombre=$(this).children(":nth-child(3)").find("Input").val();objusuarioActual.email=$(this).children(":nth-child(4)").find("Input").val();objusuariosEnSeleccion.listado.findIndex(n=>n.username===objusuarioActual.username)===-1&&objusuariosEnSeleccion.listado.push({nombre:objusuarioActual.nombre,username:objusuarioActual.username,email:objusuarioActual.email})}),LimpiarUsuarioActual(),$("#Crear_TotalIntegrantes").val(objusuariosEnSeleccion.listado.length))}function LimpiarInfo(){$("#Crear_Nombre").val("");$("#Crear_Correo").val("");$("#Crear_Usuario").flexdatalist("value","");$("#control-busqueda ul > li.input-container").show();LimpiarUsuarioActual()}function LimpiarUsuarioActual(){objusuarioActual.nombre="";objusuarioActual.username="";objusuarioActual.email=""}function MostrarEnTabla(){$("#add-content-users > tr").remove();$.each(objusuariosEnSeleccion.listado,function(n,t){$("#add-content-users").append("<tr><td><span>"+(n+1)+"<\/span><\/td><td><span>"+t.username+'<\/span><input type="hidden" data-val="true" data-val-required="El dato Usuario es requerido." id="Crear_Integrantes_'+n+'__Usuario" name="Crear.Integrantes['+n+'].Usuario" value="'+t.username+'"><\/td><td><span>'+t.nombre+'<\/span><input type="hidden" data-val="true" data-val-required="El dato Nombre es requerido." id="Crear_Integrantes_'+n+'__Nombre" name="Crear.Integrantes['+n+'].Nombre" value="'+t.nombre+'"><\/td><td><span>'+t.email+'<\/span><input type="hidden" data-val="true" data-val-required="El dato Correo es requerido." id="Crear_Integrantes_'+n+'__Correo" name="Crear.Integrantes['+n+'].Correo" value="'+t.email+'"><\/td><td class="indicador text-center"><button class="btn btn-link" onClick="Eliminar(\''+t.username+"',"+n+')"><i class="far fa-trash-alt font-gray"><\/i><\/button><\/td><\/tr>')});$("#Crear_TotalIntegrantes").val(objusuariosEnSeleccion.listado.length)}function Eliminar(n,t){objusuariosEnSeleccion.listado.length>0&&(objusuariosEnSeleccion.listado.splice(t,1),MostrarEnTabla(),LimpiarInfo())}var userAdd=[],objusuarioBusqueda={nombre:"",username:"",email:""},objusuarioActual={nombre:"",username:"",email:""},objusuariosEnSeleccion={listado:[]},objprecarga={conteo:0},objWebRoot={route:"",token:""},objUser={username:""};$(function(){return objWebRoot.route=$("#routeWebRoot").val(),objWebRoot.token=$("#TokenWebApi").val(),objUser.username=$("#user").text(),ControlAutocompletado(),ControlAgregarUsuarios(),Precarga(),!1});$.validator.setDefaults({ignore:[]});$.validator.addMethod("minimoentero",function(n,t,i){return parseInt(n)<parseInt(i[0])?!1:!0});$.validator.unobtrusive.adapters.add("minimoentero",["valor"],function(n){n.rules.minimoentero=[n.params.valor];n.messages.minimoentero=n.message});