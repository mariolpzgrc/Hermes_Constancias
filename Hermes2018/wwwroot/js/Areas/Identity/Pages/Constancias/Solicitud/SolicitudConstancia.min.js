function ObtenerTipodePersonalByUser(n){objTipoPersonalByUser.urln=objWebRoot.route+"api/constancias/ObtieneCveLogin_TP";$.ajax({url:objTipoPersonalByUser.urln,data:JSON.stringify({sCveLogin:n}),type:"POST",contentType:"application/json; charset=utf-8",dataType:"json",beforeSend:function(n){n.setRequestHeader("Authorization","Bearer "+objWebRoot.token)},success:function(n){n&&(objUser.numeroPersonal=n.iNumPer,objTipoPersonalByUser.info=Object.keys({}),objTipoPersonalByUser.info=n.TipoPersonal)},error:function(){objTipoPersonalByUser.info=Object.keys({})},complete:function(){objTipoPersonalByUser.info.length>0?($("#select-tipos-personal").empty(),$("#select-tipos-personal").append($("<option><\/option>").val("0").html("Seleccione el tipo de personal.")),$.each(objTipoPersonalByUser.info,function(n,t){$("#select-tipos-personal").append($("<option><\/option>").val(t.Id).html(t.Id+" - "+t.TipoPersonal))})):($("#select-tipos-personal").empty(),$("#select-tipos-personal").append($("<option><\/option>").val("0").html("Seleccione el tipo del tipo de personal.")))}});$("#select-tipos-personal").change(function(){objTipoPersonalByUser.Id=parseInt($("#select-tipos-personal option:selected").val());ObtenerConstancias(objTipoPersonalByUser.Id)})}function ObtenerConstancias(n){var t=objWebRoot.route+"api/constancias/Get_HER_Constancias",i=document.getElementById("lista-tipo-Constancia");$.ajax({url:t,data:JSON.stringify({TipoPersonal:n,UserId:objUser.username}),type:"POST",contentType:"application/json; charset=utf-8",dataType:"json",error:function(){objTipoConstancia.info=Object.key({})},success:function(n){n?(objTipoConstancia.info=Object.keys({}),objTipoConstancia.info=n):($("#lista-tipo-Constancia").empty(),$("#lista-tipo-Constancia").append($('<label class="list-group-item border-0 bg-light text-center font-weight-bold">Error al cargar las constancias<\/label>')))},complete:function(){objTipoConstancia.info.length>0?($("#lista-tipo-Constancia").empty(),$("#lista-tipo-Constancia").append($('<label class="list-group-item border-0 bg-light text-center font-weight-bold">Constancias<\/label>')),$.each(objTipoConstancia.info,function(n,t){t.SolicitudActiva?$("#lista-tipo-Constancia").append('<label class="list-group-item border-0 list-group-item-action disabled"><input class="form-check-input me-1" type="radio" name="constancia" value="'+t.Id+'" disabled>'+t.Nombre+"<\/label>"):$("#lista-tipo-Constancia").append('<label class="list-group-item border-0 list-group-item-action"><input class="form-check-input me-1" type="radio" name="constancia" value="'+t.Id+'" >'+t.Nombre+"<\/label>")})):($("#lista-tipo-Constancia").empty(),$("#lista-tipo-Constancia").append($('<label class="list-group-item border-0 bg-light text-center font-weight-bold">Constancias no disponibles<\/label>')))}})}function validarConstancia(){var n,r;let t=$('input[name="constancia"]:checked').val();for(n="",i=0;i<document.getElementsByName("constancia").length;i++)document.getElementsByName("constancia")[i].checked&&(n=document.getElementsByName("constancia")[i].value);n!==""?(r={numeroPersonal:objUser.numeroPersonal,tipoContancia:t,tipoPersonal:objTipoPersonalByUser.Id},localStorage.setItem("queryParams",JSON.stringify(r)),window.location.href="Resumen/"+t+"/"+objTipoPersonalByUser.Id+"/"):alert("Debe escoger un tipo de constancia.")}function ObtenerSeguimientosConstancia(n){objConstanciasSeguimiento.urln=objWebRoot.route+"api/constancias/GET_HER_SolicitudConstancia";$.ajax({url:objConstanciasSeguimiento.urln,type:"POST",data:JSON.stringify({UsuarioId:objUser.username,NumPagina:n}),contentType:"application/json; charset=utf-8",dataType:"json",async:!0,beforeSend:function(n){n.setRequestHeader("Authorization","Bearer "+objWebRoot.token);objConstanciasSeguimiento.info=Object.keys({});$("#contiene-cargador .loader").removeClass("d-none");$("#Constacias-historico tbody").fadeOut(100,"linear")},success:function(n){objConstanciasSeguimiento.info=Object.keys({});objConstanciasSeguimiento.info=n},error:function(){objConstanciasSeguimiento.info=Object.keys({});$("#contiene-cargador .loader").removeClass("d-none").addClass("d-none")},complete:function(){objConstanciasSeguimiento.info.Elementos.length>0?(objPaginacion.opciones.startPage=n,objPaginacion.opciones.totalPages=objConstanciasSeguimiento.info.TotalPaginas,$("#contenedor-paginacion ul").empty(),$("#paginacion-costancias").twbsPagination("destroy"),$("#paginacion-costancias").twbsPagination(objPaginacion.opciones)):($("#contenedor-paginacion ul").empty(),$("#paginacion-costancias").twbsPagination("destroy"));ProcesaSeguimiento();$("#contiene-cargador .loader").removeClass("d-none").addClass("d-none");$("#Constacias-historico tbody").fadeIn(500,"linear")}})}function ProcesaSeguimiento(){$("#Constacias-historico tbody").empty();objConstanciasSeguimiento.info.Elementos.length>0?(objElementos.elementospaginaactual=objConstanciasSeguimiento.info.PaginaActual,$.each(objConstanciasSeguimiento.info.Elementos,function(n,t){objtr.elementobase=Object.keys({});objtr.elementobase=$("<tr>").append($("<td>").append($('<a class="font-dark">'+t.Folio.toUpperCase()+"<\/a>")),$("<td>").append($('<a class="font-dark">'+t.NombreConstancia+"<\/a>")),$("<td>").append($('<a class="font-dark">'+t.NombreEstado+"<\/a>")),$("<td>").append($('<a class="font-dark">'+moment(t.FechaSolicitud).locale("es").format("DD[/]MM[/]YYYY")+"<\/a>")),$("<td>").append(t.FechaEntrega?$('<a class="font-dark">'+moment(t.FechaEntrega).locale("es").format("DD[/]MM[/]YYYY")+"<\/a>"):""));$("#Constacias-historico tbody").append(objtr.elementobase)}),objSeleccion.total=$("#Constacias-historico tbody tr th input:checked").length,objElementos.elementospaginaactual===objSeleccion.total&&objElementos.elementospaginaactual>0?$("#checkbox_all").prop("checked",!0):objElementos.elementospaginaactual>objSeleccion.total&&$("#checkbox_all").prop("checked",!1)):(objtr.elementobase=Object.keys({}),objtr.elementobase=$('<tr class="table-light">').append($('<td colspan="8" class="text-center">').text("Sin constancias para mostrar")),$("#Constacias-historico tbody").append(objtr.elementobase))}var objWebRoot={route:"",token:""},objTipoPersonal={urln:"",info:Object.keys({}),Id:0},objTipoPersonalByUser={urln:"",info:Object.keys({}),Id:0},objTipoConstancia={urln:"",info:Object.keys({}),Id:0},objUser={username:"",usersession:"",userTipo:"",numeroPersonal:0},objtr={elementobase:Object.keys({})},objSeleccion={elementos:Object.keys({}),indice:0,total:0},objElementos={elementospaginaactual:0},objConstanciasSeguimiento={urln:"",info:Object.keys({}),exportar:[],descarga:Object.keys({})},objPaginacion={opciones:{totalPages:1,visiblePages:3,startPage:1,initiateStartPageClick:!1,pageVariable:"{{pagina}}",first:"Primero",prev:"Anterior",next:"Siguiente",last:"Ãšltimo",onPageClick:function(n,t){ObtenerSeguimientosConstancia(t)}}};$(document).ready(function(){objUser.username=$("#user").text();objUser.usersession=$("#FolioSession").val();objWebRoot.token=$("#TokenWebApi").val();console.log(objWebRoot.token);ObtenerTipodePersonalByUser(objUser.username);ObtenerSeguimientosConstancia(1)});